<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.show.user.dao.SysMenuDao">

	<resultMap type="org.show.user.bean.Menu" id="menuMap">
		<id column="menu_id" property="id"/>
		<result column="menu_name" property="text"/>
		<result column="menu_url" property="url"/>
		<result column="menu_pid" property="parentId"/>
		<result column="menu_order" property="order"/>
		<result column="menu_level" property="level"/>
	</resultMap>

	<select id="queryLoginMenuList" parameterType="java.util.Map" resultMap="menuMap">
		select menu.menu_id,menu.menu_name,menu.menu_pid,menu.menu_url,menu.menu_level,menu.menu_order from t_sys_menu menu LEFT JOIN sys_role_menu_relation rm on menu.menu_id = rm.menu_id
		LEFT JOIN t_sys_role role on role.role_id = rm.role_id
		LEFT JOIN sys_user_role_relation ur ON ur.role_id = role.role_id
		LEFT JOIN t_sys_user u on ur.user_id = u.user_id
		where menu.is_used ='Y'
		and role.is_used ='Y'
		and u.is_used ='Y'
		and u.user_id = #{user_id}
	</select>

	<sql id="allColumns">
		menu_id,lrry,date_format(lrsj,'%Y-%m-%d %H:%i')lrsj,xgry,xgrq,
		menu_name,menu_pid,menu_url,menu_level,menu_order,is_used
	</sql>

	<select id="queryMenuListAll" parameterType="java.util.Map" resultType="java.util.Map">
		select
		<include refid="allColumns"></include>
		from t_sys_menu
	</select>

	<select id="queryMenuPage" parameterType="java.util.Map" resultType="java.util.Map">
		select
		<include refid="allColumns"></include>
		from t_sys_menu
		where  1=1

		limit #{start},#{pageSize}

	</select>

	<select id="countMenu" parameterType="java.util.Map" resultType="java.lang.Integer">
		select count(1) from t_sys_menu
		where  1=1
	</select>

</mapper>